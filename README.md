# 通讯录管理系统

一个基于 C++ 的桌面通讯录管理应用，采用 ImGui + SFML 构建图形用户界面，展示了单例设计模式的实践应用。

## 项目概述

本项目是一个功能完善的通讯录管理系统，提供直观的图形界面来管理联系人信息。用户可以通过该系统添加、修改、删除和搜索联系人，所有数据以 JSON 格式持久化存储。

## 核心功能

### 1. 联系人管理
- **添加联系人**：支持添加新的联系人信息，包括编号、姓名、性别、电话、邮箱地址和通讯地址
- **修改联系人**：根据编号查找并修改已存在的联系人信息
- **删除联系人**：根据编号删除指定的联系人
- **查看联系人**：在主界面以表格形式展示所有联系人信息

### 2. 搜索功能
- **全字段搜索**：支持对联系人的任意字段（编号、姓名、性别、电话、邮箱、地址）进行模糊搜索
- **搜索结果展示**：以表格形式展示搜索结果
- **重置搜索**：可随时取消搜索过滤，返回完整联系人列表

### 3. 数据持久化
- **保存数据**：将当前通讯录数据保存到 JSON 文件（contacts.json）
- **加载数据**：从 JSON 文件加载已保存的通讯录数据
- **自动格式化**：使用结构化的 JSON 格式存储，便于数据查看和维护

## 技术架构

### 架构组件

#### 1. **Person（联系人实体）**
- 数据结构，表示单个联系人的所有信息
- 包含字段：编号、姓名、性别、通讯地址、邮箱、电话号码
- 支持 JSON 序列化和反序列化

#### 2. **Manager（业务逻辑层）**
- 负责所有联系人数据的业务逻辑处理
- 主要功能：
  - 数据加载和保存
  - 联系人的增删改查
  - 搜索和过滤功能
  - ID 唯一性校验

#### 3. **ManagerSingleton（单例管理器）**
- 提供 Manager 的全局唯一实例
- 确保整个应用程序共享同一个数据管理器

#### 4. **UI（用户界面层）**
- 负责所有图形界面的渲染和用户交互
- 使用 ImGui 绘制菜单栏、表格和弹窗
- 处理用户输入和界面状态管理

### 技术栈

- **编程语言**：C++
- **图形界面**：
  - [ImGui](https://github.com/ocornut/imgui)：即时模式图形用户界面库
  - [SFML](https://www.sfml-dev.org/)：简单快速的多媒体库，提供窗口和事件处理
- **数据序列化**：[nlohmann/json](https://github.com/nlohmann/json)：现代 C++ JSON 库
- **包管理**：vcpkg

## 设计思路

### 1. 设计模式

#### 单例模式（Singleton Pattern）
- **应用场景**：ManagerSingleton 类
- **设计目的**：
  - 确保整个应用程序只有一个 Manager 实例
  - 提供全局访问点，方便 UI 层访问数据管理功能
  - 避免数据不一致问题
- **实现方式**：通过静态成员变量存储唯一实例，提供静态方法访问
  ```cpp
  // ManagerSingleton类：Manager的一个单例，提供全局共享
  class ManagerSingleton {
  private:
      static Manager instance;
  public:
      static Manager& get_instance();
  };
  ```

### 2. 分层架构

项目采用清晰的三层架构设计：

```
┌─────────────────────────────────┐
│     UI Layer (UI.cpp/h)         │  ← 用户界面层
│  - 绘制界面                      │
│  - 处理用户交互                   │
└─────────────────────────────────┘
            ↓
┌─────────────────────────────────┐
│  Business Logic Layer           │  ← 业务逻辑层
│  (Manager, ManagerSingleton)    │
│  - 数据管理                      │
│  - 业务规则                      │
└─────────────────────────────────┘
            ↓
┌─────────────────────────────────┐
│   Data Layer (Person.cpp/h)     │  ← 数据层
│  - 数据结构定义                   │
│  - JSON 序列化                   │
└─────────────────────────────────┘
```

**优势**：
- **低耦合**：各层职责明确，相互独立
- **易维护**：修改某一层不影响其他层
- **可扩展**：便于添加新功能或更换实现

### 3. 数据持久化设计

- **存储格式**：JSON
  - 人类可读，便于调试
  - 易于解析和序列化
  - 跨平台兼容
- **存储策略**：手动保存/加载
  - 用户控制数据保存时机
  - 避免频繁 I/O 操作影响性能

### 4. 用户界面设计

- **即时模式 GUI**：使用 ImGui
  - 代码简洁，易于维护
  - 快速开发原型
  - 适合工具类应用
- **中文界面**：
  - 使用思源黑体字体支持中文显示
  - 所有菜单和标签均为中文
- **响应式布局**：
  - 主窗口自动适配窗口大小
  - 弹窗居中显示

### 5. 数据验证

- **ID 唯一性**：添加和修改时检查编号是否已存在
- **操作反馈**：提供清晰的成功/失败提示
- **数据完整性**：确保所有字段正确保存和加载

## 项目结构

```
cpp-design/
├── ImGui/                      # 主项目目录
│   ├── main.cpp               # 程序入口
│   ├── Manager.h/cpp          # 业务逻辑管理器
│   ├── ManagerSingleton.h/cpp # 单例管理器
│   ├── Person.h/cpp           # 联系人数据结构
│   ├── UI.h/cpp               # 用户界面
│   ├── contacts.json          # 联系人数据文件
│   └── SourceHanSansCN-Regular.otf  # 中文字体
├── vcpkg.json                 # 依赖配置
└── cppDesign.slnx             # Visual Studio 解决方案
```

## 依赖项

根据 `vcpkg.json` 配置，项目依赖：

- **sfml**：窗口和图形渲染
- **imgui-sfml**：ImGui 与 SFML 的集成
- **nlohmann-json**：JSON 数据处理

## 构建和运行

### 前置要求

- C++ 编译器（支持 C++17 或更高版本）
- vcpkg 包管理器
- Visual Studio 2022 或其他支持的 IDE

### 构建步骤

1. 克隆仓库：
   ```bash
   git clone https://github.com/polymer1215/cpp-design.git
   cd cpp-design
   ```

2. 使用 vcpkg 安装依赖：
   ```bash
   vcpkg install
   ```

3. 使用 Visual Studio 打开 `cppDesign.slnx`

4. 构建并运行项目

### 运行说明

- 首次运行时，如果 `contacts.json` 不存在，将显示空的通讯录
- 使用菜单栏的功能进行操作：
  - **文件** → 加载/保存：管理数据持久化
  - **编辑** → 添加/修改/删除：管理联系人
  - **搜索** → 使用搜索/重置搜索：查找联系人

## 扩展性

本项目设计具有良好的扩展性，可以轻松添加以下功能：

- **导出功能**：支持导出为 CSV、Excel 等格式
- **批量操作**：批量导入、删除联系人
- **分组管理**：按类别或标签对联系人分组
- **高级搜索**：支持多条件组合搜索
- **数据加密**：对敏感信息进行加密存储
- **云同步**：支持数据云端备份和同步
- **更多设计模式**：可引入工厂模式、观察者模式等

## 学习价值

本项目适合作为学习材料，涵盖以下知识点：

1. **设计模式实践**：单例模式的实际应用
2. **C++ 现代特性**：智能指针、STL 容器、Lambda 表达式
3. **GUI 开发**：ImGui 即时模式 GUI 编程
4. **数据持久化**：JSON 序列化和文件操作
5. **软件架构**：分层设计和模块化编程

## 许可证

请查看项目许可证文件了解详情。

## 贡献

欢迎提交 Issue 和 Pull Request！
